<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Ã— å…¬å…±åƒèˆ‡ - ä¸‹ç­è§£æ†‚æ‰€</title>
    <!-- Tailwind CSS v3 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- Icon8 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/icon8/1.0.2/icon8.min.css">
    <!-- AOS Animation Library -->
    <link href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1E5B8C',
                        secondary: '#2C7BB5',
                        tertiary: '#E8F4FC',
                        accent: '#2D8659',
                        light: '#F7F9FC',
                        dark: '#134A73'
                    },
                    fontFamily: {
                        sans: ['Noto Sans TC', 'sans-serif'],
                        serif: ['Noto Serif TC', 'serif']
                    },
                    animation: {
                        'marquee': 'marquee 20s linear infinite',
                    },
                    keyframes: {
                        marquee: {
                            '0%': { transform: 'translateX(100%)' },
                            '100%': { transform: 'translateX(-100%)' }
                        }
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .text-shadow {
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            }
            .bg-blur {
                backdrop-filter: blur(8px);
            }
            .transition-all-300 {
                transition: all 0.3s ease;
            }
        }
        
        /* è‡ªå®šç¾©æ»¾å‹•æ¢ */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #1E5B8C;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #134A73;
        }
        
        /* è·‘é¦¬ç‡ˆå®¹å™¨ */
        .marquee-container {
            overflow: hidden;
            white-space: nowrap;
            position: relative;
            width: 100%;
        }
        
        /* è·‘é¦¬ç‡ˆå‹•ç•« */
        @keyframes marquee {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }
        .marquee-content {
            display: inline-block;
            animation: marquee 20s linear infinite;
        }
        
        /* èŠå¤©æ©Ÿå™¨äººå‹•ç•« */
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        .chatbot-icon {
            animation: float 3s ease-in-out infinite;
        }
    </style>
</head>
<body class="bg-light font-sans text-dark">
    <!-- å°èˆªæ¬„ -->
    <nav class="fixed top-0 left-0 w-full bg-white bg-opacity-90 bg-blur z-50 shadow-sm">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <span class="text-primary text-2xl font-bold">AI Ã— å…¬å…±åƒèˆ‡</span>
                <span class="text-dark text-lg">ä¸‹ç­è§£æ†‚æ‰€</span>
            </div>
            <div class="hidden md:flex space-x-6">
                <a href="#about" class="hover:text-primary transition-all-300">æ ¸å¿ƒç†å¿µ</a>
                <a href="#elements" class="hover:text-primary transition-all-300">ä¸‰å¤§å…ƒç´ </a>
                <a href="#roadmap" class="hover:text-primary transition-all-300">Roadmap</a>
                <a href="#goals" class="hover:text-primary transition-all-300">æˆ‘å€‘çš„ç›®æ¨™</a>
            </div>
            <button class="md:hidden text-dark focus:outline-none" id="menu-toggle">
                <i class="fa fa-bars text-xl"></i>
            </button>
        </div>
        <!-- æ‰‹æ©Ÿèœå–® -->
        <div class="md:hidden hidden bg-white w-full" id="mobile-menu">
            <div class="container mx-auto px-4 py-2 flex flex-col space-y-3">
                <a href="#about" class="py-2 hover:text-primary transition-all-300">æ ¸å¿ƒç†å¿µ</a>
                <a href="#elements" class="py-2 hover:text-primary transition-all-300">ä¸‰å¤§å…ƒç´ </a>
                <a href="#roadmap" class="py-2 hover:text-primary transition-all-300">Roadmap</a>
                <a href="#goals" class="py-2 hover:text-primary transition-all-300">æˆ‘å€‘çš„ç›®æ¨™</a>
            </div>
        </div>
    </nav>

    <!-- ä¸»è¦–è¦ºå€ -->
    <header class="pt-24 pb-16 md:pt-32 md:pb-24 px-4 bg-gradient-to-b from-white to-light">
        <div class="container mx-auto max-w-6xl">
            <div class="flex flex-col md:flex-row items-center">
                <div class="md:w-1/2 mb-8 md:mb-0" data-aos="fade-right" data-aos-duration="1000">
                    <h1 class="text-4xl md:text-5xl lg:text-6xl font-bold text-dark mb-4">
                        æˆå°±æ¡ƒåœ’é’å¹´<br>
                        <span class="text-primary">åšå¹³å‡¡çš„è¶…äºº</span>
                    </h1>
                    <p class="text-xl md:text-2xl text-dark opacity-80 mb-6">
                        ä½ çš„ç…©æƒ±ï¼Œæˆ‘å€‘è½è¦‹ã€‚ä½ çš„æƒ³æ³•ï¼Œå€¼å¾—è¢«æ¡ç´
                    </p>
                    <div class="flex space-x-4">
                        <button class="bg-primary hover:bg-opacity-90 text-white px-6 py-3 rounded-full shadow-md transition-all-300">
                            äº†è§£æ›´å¤š
                        </button>
                        <button class="border border-primary text-primary hover:bg-primary hover:text-white px-6 py-3 rounded-full shadow-sm transition-all-300">
                            ç«‹å³åƒèˆ‡
                        </button>
                    </div>
                </div>
                <div class="md:w-1/2" data-aos="fade-left" data-aos-duration="1000">
                    <img src="/images/é’å¹´åœ¨å’–å•¡é¤¨äº¤æµimage.jpg"
                         alt="é’å¹´åœ¨å’–å•¡é¤¨äº¤æµ"
                         class="rounded-lg shadow-xl w-full">
                </div>
            </div>
        </div>
    </header>

    <!-- è·‘é¦¬ç‡ˆ -->
    <div class="bg-primary bg-opacity-10 py-3 px-4">
        <div class="marquee-container">
            <div class="marquee-content">
                <span class="text-primary font-medium text-lg">
                    AI Ã— å…¬å…±åƒèˆ‡ | ä¸‹ç­è§£æ†‚æ‰€ | ä¸‹ç­ä¹Ÿèƒ½å…¬å…±åƒèˆ‡çš„ç™‚ç™’å¯¦é©—è¨ˆç•« | AI Ã— å…¬å…±åƒèˆ‡ | ä¸‹ç­è§£æ†‚æ‰€ | ä¸‹ç­ä¹Ÿèƒ½å…¬å…±åƒèˆ‡çš„ç™‚ç™’å¯¦é©—è¨ˆç•« | 
                </span>
            </div>
        </div>
    </div>

    <!-- æ ¸å¿ƒç†å¿µ -->
    <section id="about" class="py-16 px-4 bg-white">
        <div class="container mx-auto max-w-6xl">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-12" data-aos="fade-up">æ ¸å¿ƒç†å¿µ</h2>
            <div class="bg-light rounded-2xl p-8 shadow-md" data-aos="fade-up" data-aos-delay="100">
                <p class="text-lg md:text-xl leading-relaxed mb-6">
                    ä¸‹ç­ä¹Ÿèƒ½åƒæ”¿ï¼šæ‰“é€ è·å ´é’å¹´çš„ç™‚ç™’å¼å…¬å…±åƒèˆ‡å¯¦é©—
                </p>
                <p class="text-lg leading-relaxed mb-6">
                    æ¡ƒåœ’çš„è·å ´é’å¹´é•·æœŸé¢å°å±…ä½ã€é€šå‹¤èˆ‡å·¥ä½œå£“åŠ›ï¼Œä½†å¯è¦ªã€å½ˆæ€§çš„å…¬å…±åƒèˆ‡æ–¹å¼ä»ç›¸å°ç¨€å°‘ã€‚
                </p>
                <p class="text-lg leading-relaxed">
                    æœ¬ææ¡ˆçµåˆã€Œç™‚ç™’ç©ºé–“ Ã— è¼•é‡åƒæ”¿ Ã— AIè½‰è­¯ã€ä¸‰å¤§å…ƒç´ ï¼Œå˜—è©¦æ‰“é€ å¦‚å’–å•¡é¤¨èˆ¬è¼•é¬†è¦ªè¿‘çš„åƒæ”¿æ–¹å¼ï¼Œè®“é’å¹´èƒ½è‡ªåœ¨èªªå‡ºå¿ƒè²ï¼Œä¹Ÿè®“é€™äº›çœŸå¯¦æ„Ÿå—æˆç‚ºå¸‚åºœæ”¿ç­–çš„åƒè€ƒå›é¥‹ã€‚
                </p>
            </div>
        </div>
    </section>

    <!-- ä¸‰å¤§å…ƒç´  -->
    <section id="elements" class="py-16 px-4 bg-light">
        <div class="container mx-auto max-w-6xl">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-12" data-aos="fade-up">ä¸‰å¤§å…ƒç´ èªªæ˜</h2>
            
            <!-- AIè½‰è­¯ -->
            <div class="flex flex-col md:flex-row items-center mb-16">
                <div class="md:w-1/2 mb-8 md:mb-0 md:pr-8" data-aos="fade-right">
                    <img src="/images/AIè½‰è­¯image.jpg"
                         alt="AIè½‰è­¯"
                         class="rounded-lg shadow-lg w-full">
                </div>
                <div class="md:w-1/2" data-aos="fade-left" data-aos-delay="100">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-primary bg-opacity-20 rounded-full flex items-center justify-center mr-4">
                            <i class="fa fa-comments text-primary text-2xl"></i>
                        </div>
                        <h3 class="text-2xl font-bold">AIè½‰è­¯ï½œè®“å¿ƒäº‹è®Šå»ºè­°</h3>
                    </div>
                    <p class="text-lg leading-relaxed">
                        æ”¶é›†é’å¹´çš„ç…©æƒ±èˆ‡è§€å¯Ÿï¼Œç”±AIç³»çµ±å”åŠ©åˆ†é¡èªæ„ã€æ­¸ç´è­°é¡Œï¼Œè½‰è­¯ç‚ºå…·é«”å¯åƒè€ƒçš„æ”¿ç­–å»ºè­°ï¼Œå¹«åŠ©å¸‚åºœçœ‹è¦‹æ—¥å¸¸ä¸­çš„éœ€æ±‚ç—›é»ã€‚
                    </p>
                </div>
            </div>
            
            <!-- è¼•åƒæ”¿ -->
            <div class="flex flex-col md:flex-row-reverse items-center mb-16">
                <div class="md:w-1/2 mb-8 md:mb-0 md:pl-8" data-aos="fade-left">
                    <img src="/images/è¼•åƒæ”¿image.jpg"
                         alt="è¼•åƒæ”¿"
                         class="rounded-lg shadow-lg w-full">
                </div>
                <div class="md:w-1/2" data-aos="fade-right" data-aos-delay="100">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-secondary bg-opacity-20 rounded-full flex items-center justify-center mr-4">
                            <i class="fa fa-lightbulb-o text-secondary text-2xl"></i>
                        </div>
                        <h3 class="text-2xl font-bold">è¼•åƒæ”¿ï½œå¥½æ‡‚ã€å¥½å…¥å£</h3>
                    </div>
                    <p class="text-lg leading-relaxed">
                        é€éæ•¸ä½äº’å‹•ï¼‹å¯¦é«”å¿«é–ƒï¼Œè¨­è¨ˆç°¡å–®ã€ç›´è¦ºçš„åƒèˆ‡æ–¹å¼ï¼Œè®“è·å ´é’å¹´åœ¨ç”Ÿæ´»ä¸­å°±èƒ½è‡ªåœ¨è¡¨é”ï¼Œè¼•é¬†ç•™ä¸‹è‡ªå·±çš„è²éŸ³ã€‚
                    </p>
                </div>
            </div>
            
            <!-- ç™‚ç™’ç©ºé–“ -->
            <div class="flex flex-col md:flex-row items-center">
                <div class="md:w-1/2 mb-8 md:mb-0 md:pr-8" data-aos="fade-right">
                    <img src="/images/ç—Šç™’ç©ºé–“image.jpg"
                         alt="ç™‚ç™’ç©ºé–“"
                         class="rounded-lg shadow-lg w-full">
                </div>
                <div class="md:w-1/2" data-aos="fade-left" data-aos-delay="100">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-tertiary bg-opacity-20 rounded-full flex items-center justify-center mr-4">
                            <i class="fa fa-coffee text-tertiary text-2xl"></i>
                        </div>
                        <h3 class="text-2xl font-bold">ç™‚ç™’ç©ºé–“ï½œæ‰¾å›ä¸»é«”æ„Ÿ</h3>
                    </div>
                    <p class="text-lg leading-relaxed">
                        é¸åœ¨é’å¹´ç†Ÿæ‚‰çš„ã€Œç¬¬ä¸‰ç©ºé–“ã€ï¼ˆå¦‚å’–å•¡é¤¨ã€æ›¸åº—ï¼‰èˆ‰è¾¦å¿«é–ƒæ´»å‹•ï¼Œè®“éæ­£å¼å ´åŸŸæˆç‚ºçœŸå¯¦å°è©±çš„èµ·é»ï¼Œä¹Ÿæˆç‚ºæ‰¾å›è‡ªå·±éœ€æ±‚çš„å ´æ‰€ã€‚
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- Roadmap -->
    <section id="roadmap" class="py-16 px-4 bg-white">
        <div class="container mx-auto max-w-6xl">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-12" data-aos="fade-up">Roadmap</h2>
            
            <div class="space-y-8">
                <!-- æ­¥é©Ÿ1 -->
                <div class="flex flex-col md:flex-row items-start" data-aos="fade-up">
                    <div class="md:w-1/4 mb-4 md:mb-0 flex justify-center md:justify-start">
                        <div class="w-16 h-16 bg-primary bg-opacity-20 rounded-full flex items-center justify-center">
                            <span class="text-primary text-2xl font-bold">01</span>
                        </div>
                    </div>
                    <div class="md:w-3/4">
                        <h3 class="text-xl font-bold mb-2">AI Agent å¹³å°å»ºç½®</h3>
                        <p class="text-lg leading-relaxed">
                            å»ºç½® AI Agentï¼ˆæ™ºèƒ½åŠ©ç†ç³»çµ±ï¼‰å¹³å°ï¼Œé’å¹´è¼¸å…¥ç…©æƒ±å³å¯ç²å¾—å°æ‡‰æ”¿ç­–å»ºè­°ã€‚è¡ä¼¸æ•ˆç›Šï¼šä»¥æœ€ä½æˆæœ¬å¯¦ä½œ AI æ•ˆç›Šï¼Œè©•ä¼°æœªä¾†æ“´å¤§å°å…¥èˆ‡æ‡‰ç”¨ã€‚
                        </p>
                    </div>
                </div>
                
                <!-- æ­¥é©Ÿ2 -->
                <div class="flex flex-col md:flex-row items-start" data-aos="fade-up" data-aos-delay="100">
                    <div class="md:w-1/4 mb-4 md:mb-0 flex justify-center md:justify-start">
                        <div class="w-16 h-16 bg-secondary bg-opacity-20 rounded-full flex items-center justify-center">
                            <span class="text-secondary text-2xl font-bold">02</span>
                        </div>
                    </div>
                    <div class="md:w-3/4">
                        <h3 class="text-xl font-bold mb-2">ç·šä¸Šç·šä¸‹çµåˆ</h3>
                        <p class="text-lg leading-relaxed">
                            ç·šä¸Šç·šä¸‹çµåˆï¼Œä»¥å¯¦é«”æ´»å‹•è¼”åŠ©è¡ŒéŠ·ï¼Œèˆ‰è¾¦ 3 å ´ã€Œä¸‹ç­è§£æ†‚æ‰€ã€å¿«é–ƒæ´»å‹•ï¼Œè¨­ç½®ç•™è¨€ç‰†ã€æ”¿ç­–æ‰­è›‹ç®±ç­‰äº’å‹•å€ã€‚
                        </p>
                    </div>
                </div>
                
                <!-- æ­¥é©Ÿ3 -->
                <div class="flex flex-col md:flex-row items-start" data-aos="fade-up" data-aos-delay="200">
                    <div class="md:w-1/4 mb-4 md:mb-0 flex justify-center md:justify-start">
                        <div class="w-16 h-16 bg-tertiary bg-opacity-20 rounded-full flex items-center justify-center">
                            <span class="text-tertiary text-2xl font-bold">03</span>
                        </div>
                    </div>
                    <div class="md:w-3/4">
                        <h3 class="text-xl font-bold mb-2">æ•¸æ“šåˆ†æèˆ‡ç™½çš®æ›¸</h3>
                        <p class="text-lg leading-relaxed">
                            å°‡èªæ„è³‡æ–™é€²è¡Œ NLP åˆ†æï¼Œæ•´ç† TOP5 è­°é¡Œèˆ‡å»ºè­°ã€‚ç”¢å‡ºã€Šé’å¹´çœŸå¿ƒè©±ç™½çš®æ›¸ã€‹ï¼Œæä¾›å¸‚åºœä½œç‚ºæ”¿ç­–åƒè€ƒã€‚
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- æˆ‘å€‘çš„ç›®æ¨™ -->
    <section id="goals" class="py-16 px-4 bg-light">
        <div class="container mx-auto max-w-6xl">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-12" data-aos="fade-up">æˆ‘å€‘çš„ç›®æ¨™</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <!-- ç›®æ¨™1 -->
                <div class="bg-white rounded-xl p-6 shadow-md" data-aos="fade-up">
                    <div class="w-16 h-16 bg-primary bg-opacity-20 rounded-full flex items-center justify-center mb-6">
                        <i class="fa fa-users text-primary text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-4">è§¸åŠç›®æ¨™æ—ç¾¤</h3>
                    <p class="text-lg leading-relaxed">
                        è§¸åŠè·å ´é’å¹´ã€ä¸Šç­æ—é€šå‹¤é’å¹´ã€ç„¡ç‰¹å®šå…¬å…±åƒèˆ‡ç¶“é©—è€…ã€‚
                    </p>
                </div>
                
                <!-- ç›®æ¨™2 -->
                <div class="bg-white rounded-xl p-6 shadow-md" data-aos="fade-up" data-aos-delay="100">
                    <div class="w-16 h-16 bg-secondary bg-opacity-20 rounded-full flex items-center justify-center mb-6">
                        <i class="fa fa-comments text-secondary text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-4">å›æ”¶æœ‰æ•ˆäº’å‹•</h3>
                    <p class="text-lg leading-relaxed">
                        é æœŸè‡³å°‘å›æ”¶ 300 å‰‡æœ‰æ•ˆç•™è¨€ï¼AI äº’å‹•ç´€éŒ„ã€‚
                    </p>
                </div>
                
                <!-- ç›®æ¨™3 -->
                <div class="bg-white rounded-xl p-6 shadow-md" data-aos="fade-up" data-aos-delay="200">
                    <div class="w-16 h-16 bg-tertiary bg-opacity-20 rounded-full flex items-center justify-center mb-6">
                        <i class="fa fa-line-chart text-tertiary text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-4">æå‡æ”¿ç­–é€£çµ</h3>
                    <p class="text-lg leading-relaxed">
                        æå‡é’å¹´å±€å…¬å…±åƒèˆ‡æ´»å‹•å‰µæ–°å½¢è±¡ï¼Œå¼·åŒ–èˆ‡è·å ´é’å¹´çš„æ”¿ç­–é€£çµæ„Ÿèˆ‡æ­£å‘äº’å‹•ç¶“é©—ã€‚
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- é è…³ -->
    <footer class="py-12 px-4 bg-dark text-white">
        <div class="container mx-auto max-w-6xl">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-8 md:mb-0">
                    <h3 class="text-2xl font-bold mb-2">AI Ã— å…¬å…±åƒèˆ‡</h3>
                    <p class="text-xl">ä¸‹ç­è§£æ†‚æ‰€</p>
                    <p class="text-white opacity-70 mt-2">ä¸‹ç­ä¹Ÿèƒ½å…¬å…±åƒèˆ‡çš„ç™‚ç™’å¯¦é©—è¨ˆç•«</p>
                </div>
                <div class="flex flex-col items-center md:items-end">
                    <p class="text-xl font-bold mb-2">æˆå°±æ¡ƒåœ’é’å¹´ï¼Œåšå¹³å‡¡çš„è¶…äºº</p>
                    <p class="text-white opacity-70">ä½ çš„ç…©æƒ±ï¼Œæˆ‘å€‘è½è¦‹ã€‚ä½ çš„æƒ³æ³•ï¼Œå€¼å¾—è¢«æ¡ç´</p>
                </div>
            </div>
            <div class="border-t border-white border-opacity-20 mt-8 pt-8 text-center">
                <p class="text-white opacity-70">Â© 2025 AI Ã— å…¬å…±åƒèˆ‡ - ä¸‹ç­è§£æ†‚æ‰€. ç‰ˆæ¬Šæ‰€æœ‰.</p>
            </div>
        </div>
    </footer>

    <!-- React èŠå¤©æ©Ÿå™¨äººæ›è¼‰é» -->
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>

    <script>
        // åˆå§‹åŒ–AOSå‹•ç•«åº«
        document.addEventListener('DOMContentLoaded', function() {
            AOS.init({
                duration: 800,
                once: true
            });
            
            // æ‰‹æ©Ÿèœå–®åˆ‡æ›
            const menuToggle = document.getElementById('menu-toggle');
            const mobileMenu = document.getElementById('mobile-menu');
            
            menuToggle.addEventListener('click', function() {
                mobileMenu.classList.toggle('hidden');
            });
            
            // å¹³æ»‘æ»¾å‹•
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    const targetId = this.getAttribute('href');
                    const targetElement = document.querySelector(targetId);
                    
                    if (targetElement) {
                        window.scrollTo({
                            top: targetElement.offsetTop - 80,
                            behavior: 'smooth'
                        });
                        
                        // å¦‚æœæ˜¯æ‰‹æ©Ÿèœå–®ï¼Œé»æ“Šå¾Œé—œé–‰èœå–®
                        if (!mobileMenu.classList.contains('hidden')) {
                            mobileMenu.classList.add('hidden');
                        }
                    }
                });
            });
            
            // èŠå¤©æ©Ÿå™¨äººåŠŸèƒ½
            const chatbotToggle = document.getElementById('chatbot-toggle');
            const chatbotWindow = document.getElementById('chatbot-window');
            const closeChatbot = document.getElementById('close-chatbot');
            const chatMessages = document.getElementById('chat-messages');
            const chatInput = document.getElementById('chat-input');
            const sendMessage = document.getElementById('send-message');
            
            // åˆ‡æ›èŠå¤©è¦–çª—é¡¯ç¤º/éš±è—
            chatbotToggle.addEventListener('click', function() {
                chatbotWindow.classList.toggle('hidden');
            });
            
            closeChatbot.addEventListener('click', function() {
                chatbotWindow.classList.add('hidden');
            });
            
            // ç™¼é€æ¶ˆæ¯
            let sessionId = null; // ç”¨æ–¼ä¿å­˜å°è©± session ID

            function sendChatMessage() {
                const message = chatInput.value.trim();

                if (message) {
                    // æ·»åŠ ä½¿ç”¨è€…æ¶ˆæ¯
                    addUserMessage(message);

                    // æ¸…ç©ºè¼¸å…¥æ¡†
                    chatInput.value = '';

                    // ç¦ç”¨è¼¸å…¥æ¡†å’Œç™¼é€æŒ‰éˆ•
                    chatInput.disabled = true;
                    sendMessage.disabled = true;

                    // é¡¯ç¤ºæ­£åœ¨è¼¸å…¥æŒ‡ç¤ºå™¨
                    const typingIndicator = addTypingIndicator();

                    // èª¿ç”¨å¾Œç«¯ API
                    callChatAPI(message, typingIndicator);
                }
            }

            // èª¿ç”¨å¾Œç«¯èŠå¤© API
            function callChatAPI(message, typingIndicator) {
                const payload = {
                    message: message
                };

                // å¦‚æœæœ‰ session_idï¼ŒåŠ å…¥è«‹æ±‚
                if (sessionId) {
                    payload.session_id = sessionId;
                }

                // ä½¿ç”¨ fetch ç™¼é€è«‹æ±‚
                fetch('/api/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(payload)
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('ç¶²çµ¡éŸ¿æ‡‰ç•°å¸¸');
                    }

                    // ç§»é™¤æ­£åœ¨è¼¸å…¥æŒ‡ç¤ºå™¨
                    if (typingIndicator) {
                        typingIndicator.remove();
                    }

                    // å‰µå»ºä¸€å€‹æ–°çš„æ©Ÿå™¨äººæ¶ˆæ¯å®¹å™¨
                    const botMessageContainer = createBotMessageContainer();
                    const botMessageText = botMessageContainer.querySelector('p');

                    // è™•ç† SSE ä¸²æµ
                    const reader = response.body.getReader();
                    const decoder = new TextDecoder();
                    let buffer = '';
                    let fullText = '';

                    function processStream() {
                        reader.read().then(({ done, value }) => {
                            if (done) {
                                // ä¸²æµçµæŸï¼Œé‡æ–°å•Ÿç”¨è¼¸å…¥æ¡†
                                chatInput.disabled = false;
                                sendMessage.disabled = false;
                                chatInput.focus();
                                return;
                            }

                            // è§£ç¢¼æ•¸æ“š
                            buffer += decoder.decode(value, { stream: true });

                            // æŒ‰è¡Œè™•ç† SSE æ•¸æ“š
                            const lines = buffer.split('\n');
                            buffer = lines.pop(); // ä¿ç•™æœ€å¾Œä¸€å€‹æœªå®Œæˆçš„è¡Œ

                            lines.forEach(line => {
                                if (line.startsWith('data: ')) {
                                    try {
                                        const data = JSON.parse(line.substring(6));

                                        // è™•ç†ä¸åŒé¡å‹çš„äº‹ä»¶
                                        if (data.type === 'session') {
                                            // ä¿å­˜ session_id
                                            if (data.session_id) {
                                                sessionId = data.session_id;
                                            }
                                        } else if (data.type === 'text') {
                                            // è¿½åŠ æ–‡æœ¬å…§å®¹
                                            fullText += data.content;
                                            botMessageText.innerHTML = formatBotMessage(fullText);

                                            // è‡ªå‹•æ»¾å‹•åˆ°åº•éƒ¨
                                            chatMessages.scrollTop = chatMessages.scrollHeight;
                                        } else if (data.type === 'sources') {
                                            // è™•ç†è³‡æ–™ä¾†æº
                                            if (data.content && data.content.length > 0) {
                                                const sourcesHtml = createSourcesHtml(data.content);
                                                botMessageText.innerHTML += sourcesHtml;
                                                chatMessages.scrollTop = chatMessages.scrollHeight;
                                            }
                                        } else if (data.type === 'end') {
                                            // ä¸²æµçµæŸ
                                            console.log('Stream ended');
                                        } else if (data.type === 'error') {
                                            // éŒ¯èª¤è™•ç†
                                            botMessageText.innerHTML = '<span style="color: #dc2626;">æŠ±æ­‰ï¼Œè™•ç†æ‚¨çš„è«‹æ±‚æ™‚ç™¼ç”ŸéŒ¯èª¤ã€‚è«‹ç¨å¾Œå†è©¦ã€‚</span>';
                                        }
                                    } catch (e) {
                                        console.error('è§£æ SSE æ•¸æ“šéŒ¯èª¤:', e);
                                    }
                                }
                            });

                            // ç¹¼çºŒè®€å–
                            processStream();
                        }).catch(err => {
                            console.error('è®€å–ä¸²æµéŒ¯èª¤:', err);
                            botMessageText.innerHTML = '<span style="color: #dc2626;">è®€å–å›æ‡‰æ™‚ç™¼ç”ŸéŒ¯èª¤ã€‚</span>';
                            chatInput.disabled = false;
                            sendMessage.disabled = false;
                        });
                    }

                    processStream();
                })
                .catch(error => {
                    console.error('API èª¿ç”¨éŒ¯èª¤:', error);

                    // ç§»é™¤æ­£åœ¨è¼¸å…¥æŒ‡ç¤ºå™¨
                    if (typingIndicator) {
                        typingIndicator.remove();
                    }

                    // é¡¯ç¤ºéŒ¯èª¤æ¶ˆæ¯
                    addBotMessage('æŠ±æ­‰ï¼Œç„¡æ³•é€£æ¥åˆ°æœå‹™å™¨ã€‚è«‹æª¢æŸ¥ç¶²çµ¡é€£æ¥å¾Œå†è©¦ã€‚');

                    // é‡æ–°å•Ÿç”¨è¼¸å…¥æ¡†
                    chatInput.disabled = false;
                    sendMessage.disabled = false;
                });
            }

            // æ·»åŠ æ­£åœ¨è¼¸å…¥æŒ‡ç¤ºå™¨
            function addTypingIndicator() {
                const indicator = document.createElement('div');
                indicator.className = 'flex mb-4';
                indicator.innerHTML = `
                    <div class="w-8 h-8 rounded-full bg-primary flex items-center justify-center text-white mr-2 flex-shrink-0">
                        <i class="fa fa-comments"></i>
                    </div>
                    <div class="bg-white p-3 rounded-lg shadow-sm">
                        <p style="color: #6b7280;">æ­£åœ¨è¼¸å…¥<span class="typing-dots">...</span></p>
                    </div>
                `;
                chatMessages.appendChild(indicator);
                chatMessages.scrollTop = chatMessages.scrollHeight;
                return indicator;
            }

            // å‰µå»ºæ©Ÿå™¨äººæ¶ˆæ¯å®¹å™¨
            function createBotMessageContainer() {
                const container = document.createElement('div');
                container.className = 'flex mb-4';
                container.innerHTML = `
                    <div class="w-8 h-8 rounded-full bg-primary flex items-center justify-center text-white mr-2 flex-shrink-0">
                        <i class="fa fa-comments"></i>
                    </div>
                    <div class="bg-white p-3 rounded-lg shadow-sm max-w-[80%]">
                        <p></p>
                    </div>
                `;
                chatMessages.appendChild(container);
                return container;
            }

            // å‰µå»ºå¯æŠ˜ç–Šçš„è³‡æ–™ä¾†æº HTML
            function createSourcesHtml(sources) {
                if (!sources || sources.length === 0) return '';

                const sourceId = 'sources-' + Date.now();
                let html = `
                    <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(107, 114, 128, 0.3);">
                        <button onclick="toggleSources('${sourceId}')" style="
                            display: flex;
                            align-items: center;
                            gap: 4px;
                            background: none;
                            border: none;
                            color: #6b7280;
                            font-size: 12px;
                            cursor: pointer;
                            padding: 4px 0;
                        ">
                            <svg id="${sourceId}-icon" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="transition: transform 0.2s;">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                            <span>ğŸ“„ åƒè€ƒä¾†æº (${sources.length})</span>
                        </button>
                        <div id="${sourceId}" style="display: none; margin-top: 8px;">
                `;

                sources.forEach((source, index) => {
                    const text = source.text || '';
                    const truncatedText = text.length > 200 ? text.substring(0, 200) + '...' : text;
                    // å°ä¾†æºæ–‡å­—å¥—ç”¨ Markdown æ¸²æŸ“
                    const formattedText = formatSourceText(truncatedText);
                    html += `
                        <div style="
                            font-size: 11px;
                            color: #6b7280;
                            background: rgba(107, 114, 128, 0.1);
                            border-radius: 4px;
                            padding: 8px;
                            margin-bottom: 6px;
                        ">
                            <span style="font-weight: 500; color: #4b5563;">[${index + 1}]</span>
                            ${formattedText}
                        </div>
                    `;
                });

                html += `
                        </div>
                    </div>
                `;

                return html;
            }

            // åˆ‡æ›è³‡æ–™ä¾†æºé¡¯ç¤º/éš±è— (è¨­ç‚ºå…¨åŸŸå‡½æ•¸)
            window.toggleSources = function(sourceId) {
                const sourcesDiv = document.getElementById(sourceId);
                const icon = document.getElementById(sourceId + '-icon');
                if (sourcesDiv) {
                    if (sourcesDiv.style.display === 'none') {
                        sourcesDiv.style.display = 'block';
                        if (icon) icon.style.transform = 'rotate(180deg)';
                    } else {
                        sourcesDiv.style.display = 'none';
                        if (icon) icon.style.transform = 'rotate(0deg)';
                    }
                }
            };

            // æ ¼å¼åŒ–ä¾†æºæ–‡å­—ï¼ˆå®Œæ•´ Markdown æ¸²æŸ“ï¼‰
            function formatSourceText(text) {
                let formatted = text;

                // ç§»é™¤è½‰ç¾©çš„åæ–œç·š
                formatted = formatted.replace(/\\#/g, '#');
                formatted = formatted.replace(/\\\|/g, '|');
                formatted = formatted.replace(/\\\*\\\*/g, '**');
                formatted = formatted.replace(/\\\*/g, '*');
                formatted = formatted.replace(/\\-/g, '-');

                // è™•ç† Markdown è¡¨æ ¼
                const lines = formatted.split('\n');
                let inTable = false;
                let tableHtml = '';
                let resultLines = [];

                for (let i = 0; i < lines.length; i++) {
                    const line = lines[i].trim();

                    // æª¢æ¸¬æ˜¯å¦ç‚ºè¡¨æ ¼åˆ†éš”è¡Œ |---|---|---| æˆ– |:---|:---:|---:|
                    // åˆ†éš”è¡Œï¼šåŒ…å« | å’Œ -ï¼Œä¸”ä¸å«ä»»ä½•å­—æ¯æˆ–ä¸­æ–‡
                    const isSeparatorLine = line.includes('|') && line.includes('-') &&
                        !line.match(/[a-zA-Z\u4e00-\u9fa5\u3000-\u303f\uff00-\uffef0-9]/) &&
                        line.replace(/[\|\-:\s]/g, '').length === 0;

                    if (isSeparatorLine) {
                        // é€™æ˜¯åˆ†éš”è¡Œï¼Œè·³éä½†æ¨™è¨˜æˆ‘å€‘åœ¨è¡¨æ ¼ä¸­
                        if (!inTable) {
                            inTable = true;
                            tableHtml = '<table style="font-size: 10px; border-collapse: collapse; margin: 4px 0; width: 100%;">';
                        }
                        continue;
                    }

                    // æª¢æ¸¬è¡¨æ ¼è¡Œï¼ˆä»¥ | é–‹é ­æˆ–åŒ…å« | åˆ†éš”ï¼‰
                    if (line.match(/^\|.*\|$/) || line.match(/^[^|]+\|[^|]+/)) {
                        if (!inTable) {
                            inTable = true;
                            tableHtml = '<table style="font-size: 10px; border-collapse: collapse; margin: 4px 0; width: 100%;">';
                        }
                        // è§£æè¡¨æ ¼å–®å…ƒæ ¼
                        const cells = line.split('|').filter(c => c.trim() !== '');
                        const isHeader = !tableHtml.includes('<tr>');
                        const tag = isHeader ? 'th' : 'td';
                        const style = isHeader
                            ? 'style="border: 1px solid #ddd; padding: 3px; background: #f5f5f5; font-weight: bold; text-align: left;"'
                            : 'style="border: 1px solid #ddd; padding: 3px; text-align: left;"';
                        tableHtml += '<tr>' + cells.map(c => `<${tag} ${style}>${c.trim()}</${tag}>`).join('') + '</tr>';
                    } else {
                        if (inTable) {
                            tableHtml += '</table>';
                            resultLines.push(tableHtml);
                            tableHtml = '';
                            inTable = false;
                        }
                        resultLines.push(line);
                    }
                }
                if (inTable) {
                    tableHtml += '</table>';
                    resultLines.push(tableHtml);
                }
                formatted = resultLines.join('\n');

                // è™•ç†æ¨™é¡Œ #### ### ## #
                formatted = formatted.replace(/^####\s+(.+)$/gm, '<strong style="font-size: 0.95em;">$1</strong>');
                formatted = formatted.replace(/^###\s+(.+)$/gm, '<strong style="font-size: 1em;">$1</strong>');
                formatted = formatted.replace(/^##\s+(.+)$/gm, '<strong style="font-size: 1.05em;">$1</strong>');
                formatted = formatted.replace(/^#\s+(.+)$/gm, '<strong style="font-size: 1.1em;">$1</strong>');

                // è™•ç†ç²—é«” **text**
                formatted = formatted.replace(/\*\*([^*]+)\*\*/g, '<strong>$1</strong>');

                // è™•ç†é€£çµ [æ–‡å­—](url)
                formatted = formatted.replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2" target="_blank" style="color: #2563eb; text-decoration: underline;">$1</a>');

                // è™•ç†ç„¡åºåˆ—è¡¨ * item æˆ– - item
                formatted = formatted.replace(/^\*\s+(.+)$/gm, 'â€¢ $1');
                formatted = formatted.replace(/^-\s+(.+)$/gm, 'â€¢ $1');

                // è™•ç†æ›è¡Œ
                formatted = formatted.replace(/\n/g, '<br>');

                return formatted;
            }

            // æ ¼å¼åŒ–æ©Ÿå™¨äººæ¶ˆæ¯ï¼ˆæ”¯æŒ Markdown æ ¼å¼ï¼‰
            function formatBotMessage(text) {
                let formatted = text;

                // ç§»é™¤å›ç­”ä¸­çš„ã€Œè³‡æ–™ä¾†æºã€å¼•ç”¨æ–‡å­—ï¼ˆå› ç‚ºå·²æœ‰ç¨ç«‹çš„åƒè€ƒä¾†æºå€å¡Šï¼‰
                // åŒ¹é…æ ¼å¼: *(è³‡æ–™ä¾†æºï¼š...)* æˆ– ï¼ˆè³‡æ–™ä¾†æºï¼š...ï¼‰ æˆ– (è³‡æ–™ä¾†æºï¼š...)
                formatted = formatted.replace(/\*?\(è³‡æ–™ä¾†æº[ï¼š:][^)]*\)\*?/g, '');
                formatted = formatted.replace(/ï¼ˆè³‡æ–™ä¾†æº[ï¼š:][^ï¼‰]*ï¼‰/g, '');
                // æ¸…ç†å¯èƒ½æ®˜ç•™çš„ç©ºç™½è¡Œ
                formatted = formatted.replace(/\n\s*\n\s*\n/g, '\n\n');

                // å…ˆè™•ç†è½‰ç¾©çš„æ˜Ÿè™Ÿ \*\* æˆ– \*ï¼ˆä¾†è‡ª RAG è³‡æ–™ï¼‰
                formatted = formatted.replace(/\\\*\\\*/g, '**');
                formatted = formatted.replace(/\\\*/g, '*');

                // è™•ç†ç²—é«” **text** æˆ– __text__
                formatted = formatted.replace(/\*\*([^*]+)\*\*/g, '<strong>$1</strong>');
                formatted = formatted.replace(/__([^_]+)__/g, '<strong>$1</strong>');

                // ç§»é™¤æ–œé«”è™•ç† - é¿å…å–®ç¨ * ç¬¦è™Ÿè¢«èª¤åˆ¤ï¼ˆå¦‚åˆ—è¡¨é …ç›®ï¼‰
                // å¦‚éœ€æ–œé«”ï¼Œå»ºè­°ä½¿ç”¨ _text_ æ ¼å¼

                // è™•ç† Markdown é€£çµ [æ–‡å­—](url)
                formatted = formatted.replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2" target="_blank" style="color: #2563eb; text-decoration: underline;">$1</a>');

                // è™•ç†ç„¡åºåˆ—è¡¨é … * item æˆ– - itemï¼ˆè¡Œé¦–ï¼‰
                formatted = formatted.replace(/^[\*\-]\s+(.+)$/gm, '<li style="margin-left: 1.5em; list-style-type: disc;">$1</li>');

                // è™•ç†æ¨™é¡Œ ## æˆ– ### ç­‰
                formatted = formatted.replace(/^###\s+(.+)$/gm, '<h4 style="font-weight: bold; font-size: 1em; margin: 0.5em 0;">$1</h4>');
                formatted = formatted.replace(/^##\s+(.+)$/gm, '<h3 style="font-weight: bold; font-size: 1.1em; margin: 0.5em 0;">$1</h3>');
                formatted = formatted.replace(/^#\s+(.+)$/gm, '<h2 style="font-weight: bold; font-size: 1.2em; margin: 0.5em 0;">$1</h2>');

                // å°‡é€£çºŒçš„ <li> åŒ…è£æˆ <ul>
                formatted = formatted.replace(/(<li[^>]*>.*?<\/li>\n?)+/g, function(match) {
                    return '<ul style="margin: 0.5em 0; padding-left: 0;">' + match + '</ul>';
                });

                // å°‡æ›è¡Œç¬¦è½‰æ›ç‚º <br>ï¼ˆåœ¨åˆ—è¡¨å¤–ï¼‰
                formatted = formatted.replace(/\n/g, '<br>');

                // æ¸…ç†å¤šé¤˜çš„ <br> åœ¨ <ul> å’Œ <li> å‘¨åœ
                formatted = formatted.replace(/<br>\s*<ul/g, '<ul');
                formatted = formatted.replace(/<\/ul>\s*<br>/g, '</ul>');
                formatted = formatted.replace(/<br>\s*<li/g, '<li');
                formatted = formatted.replace(/<\/li>\s*<br>/g, '</li>');
                formatted = formatted.replace(/<br>\s*<h/g, '<h');
                formatted = formatted.replace(/<\/h[234]>\s*<br>/g, function(match) {
                    return match.replace('<br>', '');
                });

                return formatted;
            }
            
            sendMessage.addEventListener('click', sendChatMessage);
            
            chatInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendChatMessage();
                }
            });
            
            // æ·»åŠ ä½¿ç”¨è€…æ¶ˆæ¯åˆ°èŠå¤©è¦–çª—
            function addUserMessage(message) {
                const messageElement = document.createElement('div');
                messageElement.className = 'flex mb-4 justify-end';
                messageElement.innerHTML = `
                    <div class="bg-primary text-white p-3 rounded-lg shadow-sm max-w-[80%]">
                        <p>${message}</p>
                    </div>
                    <div class="w-8 h-8 rounded-full bg-gray-300 flex items-center justify-center ml-2 flex-shrink-0">
                        <i class="fa fa-user"></i>
                    </div>
                `;
                chatMessages.appendChild(messageElement);
                
                // æ»¾å‹•åˆ°åº•éƒ¨
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
            
            // æ·»åŠ æ©Ÿå™¨äººæ¶ˆæ¯åˆ°èŠå¤©è¦–çª—
            function addBotMessage(message) {
                const messageElement = document.createElement('div');
                messageElement.className = 'flex mb-4';
                messageElement.innerHTML = `
                    <div class="w-8 h-8 rounded-full bg-primary flex items-center justify-center text-white mr-2 flex-shrink-0">
                        <i class="fa fa-comments"></i>
                    </div>
                    <div class="bg-white p-3 rounded-lg shadow-sm max-w-[80%]">
                        <p>${message}</p>
                    </div>
                `;
                chatMessages.appendChild(messageElement);
            }
        });
    </script>
</body>
</html>
